<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Family Chore Tracker{% endblock %}</title>
    <script src="[https://cdn.tailwindcss.com](https://cdn.tailwindcss.com)"></script>
    <script src="[https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js](https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js)"></script>
    <script src="[https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js](https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js)"></script>
    <style>
        /* Add minor custom styles if needed, e.g., for flash messages */
        .fade-out {
            opacity: 0;
            transition: opacity 0.5s ease-out;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans antialiased">

    <nav class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white p-4 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <a href="{% if request.session.user_uid %}{% url 'dashboard' %}{% else %}{% url 'login' %}{% endif %}" class="text-2xl font-bold tracking-tight hover:text-blue-200 transition duration-150 ease-in-out">
                üèÜ Chore Champion
            </a>
            <div>
                {% if request.session.user_uid %}
                    <span class="mr-4 hidden sm:inline">Welcome, {{ request.session.display_name|default:'User' }}!</span>
                    <form action="{% url 'logout' %}" method="POST" class="inline" id="logout-form">
                         {% csrf_token %}
                        <button type="submit" id="logout-button" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-150 ease-in-out shadow hover:shadow-md">
                            Logout
                        </button>
                    </form>
                {% else %}
                    <a href="{% url 'login' %}" class="mr-2 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition duration-150 ease-in-out shadow hover:shadow-md">Login</a>
                    <a href="{% url 'signup' %}" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition duration-150 ease-in-out shadow hover:shadow-md">Sign Up</a>
                {% endif %}
            </div>
        </div>
    </nav>

    <main class="container mx-auto mt-6 mb-6 p-4">
        <div id="flash-messages" class="mb-4 space-y-2">
            {% if messages %}
                {% for message in messages %}
                    <div class="p-4 rounded-lg shadow-md flex justify-between items-center message-alert {% if message.tags == 'success' %}bg-green-100 border border-green-400 text-green-700{% elif message.tags == 'error' %}bg-red-100 border border-red-400 text-red-700{% elif message.tags == 'warning' %}bg-yellow-100 border border-yellow-400 text-yellow-700{% else %}bg-blue-100 border border-blue-400 text-blue-700{% endif %}" role="alert">
                        <span>{{ message }}</span>
                        <button type="button" class="ml-4 text-xl font-semibold leading-none" onclick="this.parentElement.style.display='none';">&times;</button>
                    </div>
                {% endfor %}
            {% endif %}
        </div>

        {% block content %}
        <p class="text-center text-gray-500">Loading content...</p>
        {% endblock %}
    </main>

    <footer class="text-center mt-8 p-6 bg-gray-200 text-gray-600 text-sm border-t border-gray-300">
        &copy; {% now "Y" %} Chore Champion App. Built with Django & Firebase.
    </footer>

    <script>
      // **IMPORTANT**: Replace with your project's actual Firebase configuration!
      // You can get this from the Firebase console: Project settings > General > Your apps > Web app
      const firebaseConfig = {
  apiKey: "AIzaSyC8nMx4Hs16ThhsIOwM327LT4IvN-TuHWw",
  authDomain: "earn-it-20f9f.firebaseapp.com",
  projectId: "earn-it-20f9f",
  storageBucket: "earn-it-20f9f.firebasestorage.app",
  messagingSenderId: "267714093166",
  appId: "1:267714093166:web:60d02938870a3337aac67f",
  measurementId: "G-NBZTL61899"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
      let firebaseApp;
      let firebaseAuth;
      try {
          if (!firebase.apps.length) { // Prevent re-initialization
             firebaseApp = firebase.initializeApp(firebaseConfig);
          } else {
             firebaseApp = firebase.app(); // Get default app if already initialized
          }
          firebaseAuth = firebase.auth(); // Get auth instance using compat library
          console.log("Firebase Initialized Successfully (Client-side)");
      } catch (error) {
          console.error("Error initializing Firebase (Client-side):", error);
          // Display an error message to the user on the page if Firebase fails to load
          const mainContent = document.querySelector('main');
          if (mainContent) {
              const errorDiv = document.createElement('div');
              errorDiv.className = 'p-4 rounded-lg shadow-md bg-red-100 border border-red-400 text-red-700';
              errorDiv.textContent = 'Error connecting to authentication services. Please check your connection or contact support.';
              mainContent.prepend(errorDiv);
          }
      }

      // Client-side logout handling (optional but recommended)
      const logoutButton = document.getElementById('logout-button');
      if (logoutButton && typeof firebaseAuth !== 'undefined') {
          logoutButton.addEventListener('click', async (e) => {
              e.preventDefault(); // Prevent default form submission initially
              try {
                  await firebaseAuth.signOut();
                  console.log('Firebase sign-out successful.');
                  // Now submit the Django form to clear the server session
                  document.getElementById('logout-form').submit();
              } catch (error) {
                  console.error('Firebase sign-out error:', error);
                  // Still submit the form to clear server session even if Firebase fails
                  document.getElementById('logout-form').submit();
              }
          });
      }

      // Auto-hide flash messages after a few seconds
      document.addEventListener('DOMContentLoaded', () => {
          const alerts = document.querySelectorAll('.message-alert');
          alerts.forEach(alert => {
              setTimeout(() => {
                  alert.classList.add('fade-out');
                  // Remove from DOM after fade out completes
                  setTimeout(() => alert.remove(), 500);
              }, 5000); // Hide after 5 seconds
          });
      });

    </script>

    {% block extra_js %}
    {% endblock %}

</body>
</html>
```html
{% extends 'base.html' %}

{% block title %}Login - Chore Champion{% endblock %}

{% block content %}
<div class="flex items-center justify-center min-h-[calc(100vh-200px)]"> <div class="max-w-md w-full bg-white p-8 rounded-xl shadow-lg border border-gray-200">
        <h2 class="text-3xl font-bold mb-6 text-center text-gray-800">Login to Chore Champion</h2>

        <div id="client-error-message" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 hidden" role="alert">
            <strong class="font-bold">Login Error:</strong>
            <span class="block sm:inline" id="client-error-text"></span>
        </div>

        <form id="login-form" method="POST" action="{% url 'login' %}">
            {% csrf_token %}
            <input type="hidden" name="id_token" id="id_token_input">

            <div class="mb-4">
                <label for="email" class="block text-gray-700 text-sm font-bold mb-2">Email Address:</label>
                <input type="email" id="email" name="email" required autocomplete="email" placeholder="you@example.com"
                       class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
            </div>
            <div class="mb-6">
                <label for="password" class="block text-gray-700 text-sm font-bold mb-2">Password:</label>
                <input type="password" id="password" name="password" required autocomplete="current-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                       class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
            </div>
            <div class="flex items-center justify-between mb-4">
                <button type="button" id="login-button"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out shadow hover:shadow-md disabled:opacity-50">
                    <span id="login-button-text">Login</span>
                    <span id="login-spinner" class="hidden animate-spin inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full ml-2"></span>
                </button>
            </div>
             <div class="text-center text-sm">
                <a class="inline-block align-baseline font-bold text-blue-600 hover:text-blue-800" href="#">
                    Forgot Password? </a>
            </div>
            <hr class="my-6 border-gray-300">
            <div class="text-center">
                 <p class="text-gray-600">Don't have an account?
                    <a href="{% url 'signup' %}" class="font-bold text-blue-600 hover:text-blue-800">Sign Up Here</a>
                 </p>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  // Client-side Firebase Login Logic
  const loginForm = document.getElementById('login-form');
  const loginButton = document.getElementById('login-button');
  const loginButtonText = document.getElementById('login-button-text');
  const loginSpinner = document.getElementById('login-spinner');
  const emailInput = document.getElementById('email');
  const passwordInput = document.getElementById('password');
  const idTokenInput = document.getElementById('id_token_input');
  const clientErrorDiv = document.getElementById('client-error-message');
  const clientErrorText = document.getElementById('client-error-text');

  // Function to show/hide spinner and disable button
  function setLoadingState(isLoading) {
      if (isLoading) {
          loginButton.disabled = true;
          loginButtonText.classList.add('hidden');
          loginSpinner.classList.remove('hidden');
          clientErrorDiv.classList.add('hidden'); // Hide previous errors
      } else {
          loginButton.disabled = false;
          loginButtonText.classList.remove('hidden');
          loginSpinner.classList.add('hidden');
      }
  }

  // Function to display client-side errors
  function showClientError(message) {
      clientErrorText.textContent = message;
      clientErrorDiv.classList.remove('hidden');
  }

  if (loginButton && typeof firebaseAuth !== 'undefined') {
      loginButton.addEventListener('click', async (e) => {
        e.preventDefault(); // Prevent default form submission
        const email = emailInput.value;
        const password = passwordInput.value;

        if (!email || !password) {
            showClientError("Please enter both email and password.");
            return;
        }

        setLoadingState(true);

        try {
          // Use Firebase Auth (compat) to sign in
          const userCredential = await firebaseAuth.signInWithEmailAndPassword(email, password);
          const user = userCredential.user;
          console.log("Firebase login successful (client-side):", user.uid);

          // Get the ID token (force refresh to ensure it's fresh)
          const idToken = await user.getIdToken(/* forceRefresh */ true);
          console.log("Obtained Firebase ID Token (client-side). Length:", idToken.length);

          // Set the obtained token in the hidden form input
          idTokenInput.value = idToken;

          // Now, submit the form to the Django backend endpoint
          // The backend will verify this token and create the Django session
          loginForm.submit();
          // Spinner will remain until page redirects

        } catch (error) {
          console.error("Firebase login failed (client-side):", error.code, error.message);
          // Provide user-friendly error messages
          let errorMessage = "An unknown error occurred. Please try again.";
          switch (error.code) {
              case 'auth/invalid-email':
                  errorMessage = "Invalid email address format.";
                  break;
              case 'auth/user-disabled':
                  errorMessage = "This user account has been disabled.";
                  break;
              case 'auth/user-not-found':
              case 'auth/wrong-password':
              case 'auth/invalid-credential': // More generic error in newer SDK versions
                  errorMessage = "Invalid email or password. Please check your credentials.";
                  break;
              case 'auth/network-request-failed':
                   errorMessage = "Network error. Please check your internet connection.";
                   break;
              // Add more specific cases as needed
          }
          showClientError(errorMessage);
          setLoadingState(false); // Re-enable button
        }
      });
  } else if (!loginButton) {
      console.error("Login button not found.");
  } else {
      console.error("Firebase Auth not initialized. Cannot set up login handler.");
      showClientError("Authentication service failed to load. Please refresh the page or contact support.");
      loginButton.disabled = true; // Disable login if Firebase isn't ready
  }
</script>
{% endblock %}
```html
{% extends 'base.html' %}

{% block title %}Sign Up - Chore Champion{% endblock %}

{% block content %}
<div class="flex items-center justify-center min-h-[calc(100vh-200px)] py-8">
    <div class="max-w-lg w-full bg-white p-8 rounded-xl shadow-lg border border-gray-200">
        <h2 class="text-3xl font-bold mb-6 text-center text-gray-800">Create Your Account</h2>

        <form method="POST" action="{% url 'signup' %}" id="signup-form">
            {% csrf_token %}

            <div class="mb-4">
                <label for="display_name" class="block text-gray-700 text-sm font-bold mb-2">Your Name:</label>
                <input type="text" id="display_name" name="display_name" value="{{ display_name|default:'' }}" required placeholder="e.g., Jane Doe"
                       class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
            </div>

            <div class="mb-4">
                <label for="email" class="block text-gray-700 text-sm font-bold mb-2">Email Address:</label>
                <input type="email" id="email" name="email" value="{{ email|default:'' }}" required autocomplete="email" placeholder="you@example.com"
                       class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
            </div>

            <div class="mb-6">
                <label for="password" class="block text-gray-700 text-sm font-bold mb-2">Password:</label>
                <input type="password" id="password" name="password" required autocomplete="new-password" placeholder="Choose a strong password"
                       class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
                </div>

            <div class="mb-6">
                <label for="role" class="block text-gray-700 text-sm font-bold mb-2">Your Role:</label>
                <select id="role" name="role" required onchange="toggleFamilyFields()"
                        class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
                    <option value="">-- Select Role --</option>
                    <option value="parent" {% if role == 'parent' %}selected{% endif %}>Parent</option>
                    <option value="child" {% if role == 'child' %}selected{% endif %}>Child</option>
                </select>
            </div>

            <div id="parent-fields" class="mb-6 space-y-4" style="display: {% if role == 'parent' %}block{% else %}none{% endif %};">
                 <p class="text-sm text-gray-600">As a parent, you can create a new family or join an existing one using a Family Code/ID provided by another parent.</p>
                 <div>
                    <label for="family_name" class="block text-gray-700 text-sm font-bold mb-2">New Family Name (Optional):</label>
                    <input type="text" id="family_name" name="family_name" value="{{ family_name|default:'' }}" placeholder="e.g., The Smiths"
                           class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
                 </div>
                 <div class="text-center my-2 text-gray-500 font-semibold">OR</div>
                 <div>
                    <label for="family_code_parent" class="block text-gray-700 text-sm font-bold mb-2">Join Existing Family Code/ID (Optional):</label>
                    <input type="text" id="family_code_parent" name="family_code" value="{{ family_code|default:'' }}" placeholder="Enter code from another parent"
                           class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
                 </div>
            </div>

            <div id="child-fields" class="mb-6" style="display: {% if role == 'child' %}block{% else %}none{% endif %};">
                <p class="text-sm text-gray-600 mb-2">As a child, you need a Family Code/ID provided by your parent to join their family group.</p>
                <label for="family_code_child" class="block text-gray-700 text-sm font-bold mb-2">Family Code/ID (Required):</label>
                <input type="text" id="family_code_child" name="family_code" value="{{ family_code|default:'' }}" required placeholder="Enter code from parent"
                       class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
            </div>

            <div class="flex items-center justify-center mb-4">
                <button type="submit"
                        class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out shadow hover:shadow-md">
                    Create Account
                </button>
            </div>

            <hr class="my-6 border-gray-300">
            <div class="text-center">
                 <p class="text-gray-600">Already have an account?
                    <a href="{% url 'login' %}" class="font-bold text-blue-600 hover:text-blue-800">Login Here</a>
                 </p>
            </div>
        </form>
    </div>
</div>

<script>
  function toggleFamilyFields() {
    const roleSelect = document.getElementById('role');
    const parentFields = document.getElementById('parent-fields');
    const childFields = document.getElementById('child-fields');
    const familyNameInput = document.getElementById('family_name');
    const familyCodeParentInput = document.getElementById('family_code_parent');
    const familyCodeChildInput = document.getElementById('family_code_child');

    if (roleSelect.value === 'parent') {
      parentFields.style.display = 'block';
      childFields.style.display = 'none';
      // Make child input not required and clear it
      familyCodeChildInput.required = false;
      familyCodeChildInput.value = '';
      // Parent fields are optional depending on whether creating or joining
      familyNameInput.required = false; // Handled by server-side logic
      familyCodeParentInput.required = false; // Handled by server-side logic
      // Copy value from parent code input to child code input (since name="family_code" is shared)
      familyCodeParentInput.oninput = () => familyCodeChildInput.value = familyCodeParentInput.value;


    } else if (roleSelect.value === 'child') {
      parentFields.style.display = 'none';
      childFields.style.display = 'block';
      // Make parent inputs not required and clear them
      familyNameInput.required = false;
      familyNameInput.value = '';
      familyCodeParentInput.required = false;
      familyCodeParentInput.value = '';
       // Make child code input required
      familyCodeChildInput.required = true;
      // Copy value from child code input to parent code input (since name="family_code" is shared)
       familyCodeChildInput.oninput = () => familyCodeParentInput.value = familyCodeChildInput.value;


    } else {
      parentFields.style.display = 'none';
      childFields.style.display = 'none';
      // Clear requirements and values
      familyNameInput.required = false;
      familyCodeParentInput.required = false;
      familyCodeChildInput.required = false;
      familyNameInput.value = '';
      familyCodeParentInput.value = '';
      familyCodeChildInput.value = '';
    }
  }

  // Ensure fields are correctly shown/hidden on page load if form is re-rendered with errors
  document.addEventListener('DOMContentLoaded', toggleFamilyFields);

  // Logic to ensure only one of family_name or family_code_parent is filled for parents
  // (Server-side validation is the primary check)
  const familyNameInput = document.getElementById('family_name');
  const familyCodeParentInput = document.getElementById('family_code_parent');
  if(familyNameInput && familyCodeParentInput){
      familyNameInput.addEventListener('input', () => {
          if(familyNameInput.value.trim() !== '') {
              familyCodeParentInput.disabled = true;
              familyCodeParentInput.classList.add('bg-gray-100');
          } else {
              familyCodeParentInput.disabled = false;
              familyCodeParentInput.classList.remove('bg-gray-100');
          }
           // Update the shared hidden input
           document.getElementById('family_code_child').value = familyCodeParentInput.value;
      });
      familyCodeParentInput.addEventListener('input', () => {
          if(familyCodeParentInput.value.trim() !== '') {
              familyNameInput.disabled = true;
              familyNameInput.classList.add('bg-gray-100');
          } else {
              familyNameInput.disabled = false;
              familyNameInput.classList.remove('bg-gray-100');
          }
           // Update the shared hidden input
           document.getElementById('family_code_child').value = familyCodeParentInput.value;
      });
  }


</script>
{% endblock %}

```html
{% extends 'base.html' %}

{% block title %}Parent Dashboard - Chore Champion{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6 text-gray-800">Parent Dashboard</h1>
<div class="mb-6 p-4 bg-indigo-100 border border-indigo-300 rounded-lg shadow-sm">
    <p class="text-indigo-800">
        <span class="font-semibold">Family Code/ID:</span>
        <code class="ml-2 bg-indigo-200 text-indigo-900 px-2 py-1 rounded font-mono text-sm">{{ family_id }}</code>
        <span class="block text-sm mt-1">Share this code with children so they can join your family group when signing up.</span>
    </p>
</div>


<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg border border-gray-200 space-y-6">
        <h2 class="text-2xl font-semibold mb-4 text-gray-700 border-b pb-2">Manage Chores</h2>

        <form action="{% url 'add_chore' %}" method="POST" class="space-y-4">
            {% csrf_token %}
            <h3 class="text-lg font-medium text-gray-600">Add New Chore</h3>
            <div>
                <label for="chore-name" class="block text-sm font-medium text-gray-700 mb-1">Chore Name:</label>
                <input type="text" id="chore-name" name="name" required placeholder="e.g., Walk the dog"
                       class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
            </div>
            <div>
                <label for="chore-points" class="block text-sm font-medium text-gray-700 mb-1">Points Value:</label>
                <input type="number" id="chore-points" name="points" required min="1" placeholder="e.g., 10"
                       class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
            </div>
            <div>
                <label for="chore-desc" class="block text-sm font-medium text-gray-700 mb-1">Description (Optional):</label>
                <textarea id="chore-desc" name="description" rows="2" placeholder="e.g., Morning walk around the block"
                          class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out"></textarea>
            </div>
            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out shadow hover:shadow-md">
                Add Chore Definition
            </button>
        </form>

        <hr class="border-gray-300">

        <div>
            <h3 class="text-lg font-medium text-gray-600 mb-2">Active Chores List</h3>
            <div class="max-h-60 overflow-y-auto space-y-2 pr-2">
                {% for chore in active_chores %}
                    <div class="bg-gray-50 p-3 rounded-md border border-gray-200 flex justify-between items-center">
                        <span class="text-sm">{{ chore.name }} ({{ chore.points }} pts)</span>
                        </div>
                {% empty %}
                    <p class="text-sm text-gray-500 italic">No active chores defined yet. Add one above!</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg border border-gray-200 space-y-6">
        <h2 class="text-2xl font-semibold mb-4 text-gray-700 border-b pb-2">Assign Chores</h2>

        <form action="{% url 'assign_chore' %}" method="POST" class="space-y-4">
             {% csrf_token %}
            <h3 class="text-lg font-medium text-gray-600">Assign a Chore</h3>
             {% if not active_chores or not children %}
                 <p class="text-sm text-yellow-700 bg-yellow-100 p-3 rounded-md border border-yellow-300">
                     You need to add at least one chore definition and have at least one child in the family before you can assign chores.
                 </p>
             {% else %}
                 <div>
                    <label for="assign-chore-id" class="block text-sm font-medium text-gray-700 mb-1">Select Chore:</label>
                    <select id="assign-chore-id" name="chore_id" required
                            class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
                        <option value="">-- Select Chore --</option>
                        {% for chore in active_chores %}
                        <option value="{{ chore.id }}">{{ chore.name }} ({{ chore.points }} pts)</option>
                        {% endfor %}
                    </select>
                </div>
                 <div>
                    <label for="assign-child-uid" class="block text-sm font-medium text-gray-700 mb-1">Assign To Child:</label>
                    <select id="assign-child-uid" name="child_uid" required
                            class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out">
                         <option value="">-- Select Child --</option>
                        {% for child in children %}
                        <option value="{{ child.id }}">{{ child.display_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out shadow hover:shadow-md">
                    Assign Chore to Child
                </button>
             {% endif %}
        </form>
    </div>

    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg border border-gray-200 space-y-6">
        <h2 class="text-2xl font-semibold mb-4 text-gray-700 border-b pb-2">Monitor & Verify</h2>

        <div>
            <h3 class="text-lg font-medium text-gray-600 mb-2">Chores Awaiting Verification</h3>
            <div class="max-h-60 overflow-y-auto space-y-2 pr-2">
                {% set verification_needed = false %}
                {% for assignment in assignments %}
                    {% if assignment.status == 'completed' %}
                        {% set verification_needed = true %}
                        <div class="mb-2 p-3 border border-yellow-300 bg-yellow-50 rounded-lg flex flex-col sm:flex-row justify-between sm:items-center space-y-2 sm:space-y-0">
                            <div class="text-sm">
                                <span class="font-semibold">{{ assignment.chore_name }}</span> - {{ assignment.child_name }}
                                <span class="block text-xs text-gray-500">Completed: {{ assignment.completed_date.strftime('%b %d, %Y %I:%M %p') if assignment.completed_date else 'N/A' }}</span>
                            </div>
                             <form action="{% url 'verify_chore' assignment.id %}" method="POST" class="inline-block flex-shrink-0">
                                 {% csrf_token %}
                                <button type="submit" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-1 px-3 rounded-md text-xs transition duration-150 ease-in-out shadow hover:shadow-md">
                                    Verify & Award Points
                                </button>
                            </form>
                        </div>
                    {% endif %}
                {% endfor %}
                {% if not verification_needed %}
                     <p class="text-sm text-gray-500 italic">No chores are currently awaiting your verification.</p>
                {% endif %}
            </div>
        </div>

         <hr class="border-gray-300">

         <div>
            <h3 class="text-lg font-medium text-gray-600 mb-2">Pending Assignments</h3>
             <div class="max-h-60 overflow-y-auto space-y-2 pr-2">
                 {% set pending_exists = false %}
                 {% for assignment in assignments %}
                     {% if assignment.status == 'pending' %}
                        {% set pending_exists = true %}
                         <div class="mb-2 p-3 border border-gray-200 bg-gray-50 rounded-lg flex justify-between items-center">
                            <div class="text-sm">
                                <span class="font-semibold">{{ assignment.chore_name }}</span> - {{ assignment.child_name }}
                                <span class="block text-xs text-gray-500">Assigned: {{ assignment.assigned_date.strftime('%b %d, %Y') if assignment.assigned_date else 'N/A' }}</span>
                            </div>
                            <span class="text-xs font-medium text-orange-600 bg-orange-100 px-2 py-0.5 rounded-full">Pending</span>
                            </div>
                     {% endif %}
                 {% endfor %}
                 {% if not pending_exists %}
                     <p class="text-sm text-gray-500 italic">No chores are currently assigned and pending completion.</p>
                 {% endif %}
             </div>
        </div>


         <hr class="border-gray-300">

         <div>
             <h3 class="text-lg font-medium text-gray-600 mb-2">Family Members</h3>
             <div class="space-y-1">
                {% for child in children %}
                    <div class="flex justify-between items-center text-sm bg-gray-50 p-2 rounded-md border border-gray-200">
                        <span>{{ child.display_name }}</span>
                        <span class="font-semibold text-green-700">{{ child.total_points|default:0 }} points</span>
                    </div>
                {% empty %}
                    <p class="text-sm text-gray-500 italic">No children have joined your family group yet.</p>
                {% endfor %}
             </div>
         </div>

          <hr class="border-gray-300">

         <div>
             <a href="{% url 'check_rewards' %}" class="block w-full text-center bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out shadow hover:shadow-md">
                 Check Reward Eligibility
             </a>
         </div>
    </div>

</div>
{% endblock %}

```html
{% extends 'base.html' %}

{% block title %}Your Dashboard - Chore Champion{% endblock %}

{% block content %}
<div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-800">Welcome back, {{ display_name }}!</h1>
    <p class="text-xl text-green-700 font-semibold mt-1">Your Total Points: <span class="text-2xl">{{ user_profile.total_points|default:0 }}</span> ‚ú®</p>
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-6">

    <div class="md:col-span-2 bg-white p-6 rounded-xl shadow-lg border border-gray-200 space-y-4">
        <h2 class="text-2xl font-semibold text-gray-700 border-b pb-2 mb-4">Your Pending Chores</h2>
        {% if pending_chores %}
            <div class="space-y-4">
                {% for assignment in pending_chores %}
                <div class="p-4 border border-blue-200 bg-blue-50 rounded-lg flex flex-col sm:flex-row justify-between sm:items-center space-y-3 sm:space-y-0 sm:space-x-4 shadow-sm hover:shadow-md transition duration-150 ease-in-out">
                    <div class="flex-grow">
                        <h3 class="font-semibold text-lg text-blue-800">{{ assignment.chore_details.name }}</h3>
                        <p class="text-sm text-green-700 font-medium">{{ assignment.chore_details.points }} points</p>
                        {% if assignment.chore_details.description %}
                        <p class="text-sm text-gray-600 mt-1">{{ assignment.chore_details.description }}</p>
                        {% endif %}
                         <p class="text-xs text-gray-500 mt-1">Assigned: {{ assignment.assigned_date.strftime('%b %d, %Y') if assignment.assigned_date else 'N/A' }}</p>
                    </div>
                    <form action="{% url 'complete_chore' assignment.id %}" method="POST" class="inline-block flex-shrink-0 w-full sm:w-auto">
                        {% csrf_token %}
                        <button type="submit" class="w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg text-sm transition duration-150 ease-in-out shadow hover:shadow-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50">
                            Mark as Done üëç
                        </button>
                    </form>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="text-center py-6 px-4 bg-gray-50 rounded-lg border border-gray-200">
                <svg class="mx-auto h-12 w-12 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <h3 class="mt-2 text-lg font-medium text-gray-900">All Caught Up!</h3>
                <p class="mt-1 text-sm text-gray-500">You have no pending chores right now. Great job!</p>
             </div>
        {% endif %}
        </div>

    <div class="md:col-span-1 bg-white p-6 rounded-xl shadow-lg border border-gray-200 space-y-4">
        <h2 class="text-2xl font-semibold text-gray-700 border-b pb-2 mb-4">üèÜ Family Leaderboard</h2>
        {% if leaderboard %}
            <ol class="space-y-3">
                {% for i, member in enumerate(leaderboard, 1) %}
                <li class="flex items-center justify-between p-3 rounded-lg border {% if member.id == request.session.user_uid %}bg-blue-100 border-blue-300{% else %}bg-gray-50 border-gray-200{% endif %}">
                    <div class="flex items-center space-x-3">
                         <span class="text-sm font-bold {% if i <= 3 %}text-yellow-600{% else %}text-gray-500{% endif %}">
                            {% if i == 1 %}ü•á
                            {% elif i == 2 %}ü•à
                            {% elif i == 3 %}ü•â
                            {% else %}{{ i }}.
                            {% endif %}
                        </span>
                        <span class="text-sm font-medium {% if member.id == request.session.user_uid %}text-blue-800 font-semibold{% else %}text-gray-700{% endif %}">
                            {{ member.display_name }} {% if member.id == request.session.user_uid %}(You){% endif %}
                        </span>
                    </div>
                    <span class="text-sm font-semibold {% if member.id == request.session.user_uid %}text-blue-800{% else %}text-green-700{% endif %}">{{ member.total_points|default:0 }} pts</span>
                </li>
                {% endfor %}
            </ol>
        {% else %}
            <p class="text-sm text-gray-500 italic">The leaderboard is empty. Be the first to earn points!</p>
        {% endif %}
    </div>
</div>
{% endblock %}

```html
{% extends 'base.html' %}

{% block title %}Reward Eligibility - Chore Champion{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6 text-gray-800">Reward Eligibility</h1>

<div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 mb-6">
    <h2 class="text-2xl font-semibold text-gray-700 mb-3">Children Eligible for Rewards</h2>
    <p class="text-sm text-gray-600 mb-4">The following children have earned <strong class="text-green-700">{{ reward_threshold }} points</strong> or more and might be eligible for a reward!</p>

    {% if eligible_children %}
        <div class="space-y-3">
            {% for child in eligible_children %}
                <div class="p-4 border border-green-300 bg-green-50 rounded-lg flex flex-col sm:flex-row justify-between sm:items-center space-y-2 sm:space-y-0">
                    <div class="text-sm">
                        <span class="font-semibold text-lg text-green-800">{{ child.display_name }}</span>
                        <span class="block text-green-700">{{ child.total_points|default:0 }} points</span>
                    </div>
                    <div class="flex-shrink-0">
                        <span class="text-xs text-gray-500 italic">(Manual action needed)</span>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-sm text-gray-500 italic">No children currently meet the reward threshold of {{ reward_threshold }} points.</p>
    {% endif %}
</div>

<div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200">
     <h2 class="text-2xl font-semibold text-gray-700 mb-3">Purchase Gift Card (Manual Step)</h2>
     <p class="text-sm text-gray-600 mb-4">
         To purchase a gift card using your affiliate link, please click the link below. This will take you to the gift card provider's website.
         Remember to complete the purchase there and arrange for delivery (e.g., email to yourself).
     </p>
     <p class="text-sm text-gray-600 mb-4">
         <strong>Note:</strong> This application does not automatically purchase or send gift cards. Clicking the link helps track referrals if you have an affiliate setup.
     </p>
     <a href="{{ affiliate_link }}" target="_blank" rel="noopener noreferrer"
        class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg focus:outline-none focus:shadow-outline transition duration-150 ease-in-out shadow hover:shadow-md">
         Go to Gift Card Site (Affiliate Link)
     </a>
     <p class="text-xs text-gray-500 mt-3">Link: <code class="text-gray-700">{{ affiliate_link }}</code></p>

     <div class="mt-6 border-t pt-4">
         <h3 class="text-lg font-medium text-gray-600 mb-2">Future: Claiming Rewards</h3>
         <p class="text-sm text-gray-500">
             In the future, after giving a reward, you could click a "Claim Reward" button here. This could automatically deduct {{ reward_threshold }} points from the child's total or log the reward event. (This feature requires additional development).
         </p>
     </div>
</div>

<div class="mt-6 text-center">
    <a href="{% url 'dashboard' %}" class="text-blue-600 hover:text-blue-800">&larr; Back to Parent Dashboard</a>
</div>
{% endblock %}
